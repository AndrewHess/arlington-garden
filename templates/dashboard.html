<!DOCTYPE html>
<html>

<head>
  <meta charset='utf-8' />
  <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
  <title>Dashboard User Facing, by Keen IO</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
  <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

  <!-- Demo Dependencies -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jQuery-Knob/1.2.13/jquery.knob.min.js" type="text/javascript">
  </script>

  <!-- keen-analysis@3 -->
<!--   <script src="https://cdn.jsdelivr.net/npm/keen-analysis@3" type="text/javascript"></script>
 -->
  <!-- keen-dataviz@3 -->
  <link href="https://cdn.jsdelivr.net/npm/keen-dataviz@3/dist/keen-dataviz.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/keen-dataviz@3/dist/keen-dataviz.min.js" type="text/javascript"></script>

  <!-- Dashboard -->
  <!-- <link rel="stylesheet" type="text/css" href="customer-facing.css" />
  <script type="text/javascript" src="customer-facing.js"></script> -->

  <!-- Load the pie chart and bar chart dependencies. -->
  <script src="https://cdn.anychart.com/js/8.0.1/anychart-core.min.js"></script>
  <script src="https://cdn.anychart.com/js/8.0.1/anychart-pie.min.js"></script>
  <script src="https://cdn.anychart.com/js/8.0.1/anychart-cartesian.min.js"></script>
</head>

<body>
  <nav class="menu">
    <ul>
      <li><a href="../">Back</a></li>
      <li class="logout"><a>Logout</a></li>
    </ul>
  </nav>

  <div class="banner">
    <div class="container">
      <div class="user-photo">
        <!-- <img src="demo-user.jpg" alt="" class="img-thumbnail" /> -->
      </div>
      <div class="user-info">
        <h1>Abraham Wald</h1>
        <p class="lead lead-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 174.239 174.239" width="20" height="20" fill="#fff">
            <path
              d="M87.12 174.239C39.082 174.239 0 135.157 0 87.12S39.082 0 87.12 0s87.12 39.082 87.12 87.12-39.083 87.119-87.12 87.119zm0-159.304c-39.802 0-72.185 32.383-72.185 72.185s32.383 72.185 72.185 72.185 72.185-32.383 72.185-72.185-32.384-72.185-72.185-72.185z" />
            <path
              d="M125.32 94.587h-38.2a7.468 7.468 0 0 1-7.467-7.467V40.794a7.467 7.467 0 1 1 14.934 0v38.859h30.733a7.468 7.468 0 0 1 0 14.934z" />
          </svg>
          <span>Last Login: August 14, 2018</span>
        </p>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="content">
      <div class="data">
        <div id="chart-01"></div>
        <hr />
        <h3>Survey Data Analytics</h3>
        Data to observe:
        <select id="question_select" onchange="update_chart()">
          <option value="first_time">First Visit</option>
          <option value="attend_reason">Reason for Coming</option>
          <option value="rating">Experience Rating</option>
          <option value="water_conserving">Increased Water-Conserving Gardening Appreciation</option>
          <option value="knew_about">Previously Knew About the Garden</option>
          <option value="how_heard_about">How Visitors Hear About the Garden</option>
          <option value="post_social">Will Post to Social Media</option>
          <option value="get_involved">Getting Involved</option>
          <option value="gender">Gender</option>
          <option value="income">Income Range</option>
	        <option value="ethnicity"> Ethnicity</option>
        </select><br>

        <div id="chart_container" style="height: 30em"></div>
        <script type="text/javascript">
          function update_chart() {
            // Remove the old chart.
            document.getElementById('chart_container').innerHTML="";

            // Get the data for the selected option.
            let e = document.getElementById("question_select");
            let question_selected = e.options[e.selectedIndex].value;
            let sql_data = JSON.parse({{questions | tojson}})[question_selected];

            console.log('sql_data:', sql_data)

            let data = []
            for (key in sql_data) {
              data.push({x: key, value: sql_data[key] });
            }

            console.log('data:', data);

            // Create the appropriate chart.
            let chart = undefined;

            switch (question_selected) {
              case 'first_time':
              case 'rating':
              case 'water_conserving':
              case 'knew_about':
              case 'post_social':
              case 'gender':
              case 'income':
                chart = pie_chart(data);
                break;
              default:
                chart = bar_chart(data);
            }

            // Add the title.
            chart.title(e.options[e.selectedIndex])

            // Display the chart.
            chart.container('chart_container');
            chart.draw();
          }


          function pie_chart(data) {
            // Create the chart.
            let chart = anychart.pie();
            chart.data(data);

            // Format the chart.
            chart.legend().position("right");
            chart.legend().itemsLayout("vertical");
            chart.fill("aquastyle");
            chart.radius("50%");

            return chart;
          }

          function bar_chart(data) {
            // Create the chart.
            let chart = anychart.cartesian();

            // Add the data.
            let column = chart.column(data);
            // column.labels().enabled(true).format('${value} mln');
            column.labels().enabled(true)

            // Format the chart.
            chart.animation(true);
            chart.yScale().minimum(0);
            chart.xAxis(true);

            return chart;
          }

          // We want to initially have a chart.
          update_chart();

        </script>
      </div>
    </div>
  </div>

  <!-- Project Analytics -->
  <!-- <script type="text/javascript" src="../../assets/js/keen-analytics.js"></script> -->
</body>

</html>
